# メモ

## Apexの使いどころ
標準機能で出来ないことが出てきた場合に使用する
Salesforceはソースコードを書くことを望んでいない

SOQL＝1オブジェクトしか検索できない
SOSL=複数オブジェクトを検索できる、でもメールや電話番号といったフィールドしか利用できない

DML＝全レコード成功のみ（insert,update...）
Database Method＝一部レコードのみコミットが指定可能（Database.insert(entity, false);

## バッチApex
数百、数千万といった大量のレコードを処理するような場合に利用
インポートウィザードとかデータローダーだときついやつ

複数のApexバッチとして分割して実行
分割したバッチのうち、失敗したバッチだけロールバックという制御も可能

### 作成方法
1. クラス作成時に 〇〇インターフェースを実装する　implements database.Bathable?
2. インターフェースに応じてstart() execute() finish()メソッドを実装する

ステートレス
ステートフル：全バッチの処理件数とか出せる


## ガバナ制限
Salesforceはマルチテナントなので、特定の組織が無制限に処理負荷かけるとヤバい

イメージ

- クラウド上に001～100というテナントが存在していると仮定
- TSSは50番のテナント上にSalesforceの組織ページを配置
- 50番のテナントにはTSS以外にもA社～Z社みたいに複数会社の組織が存在

⇒この状況でTSSが作成したApexクラスが、超負荷をかける処理を実行してしまうと

　  他の組織にも影響が出てしまいそうなのはイメージできるのでは？

こういった状況が起こらないようSalesforceではガバナ制限として

色々と実施できる範囲が制限されている。

https://developer.salesforce.com/docs/atlas.ja-jp.apexcode.meta/apexcode/apex_gov_limits.htm

### 重要ガバナポイント
CPU使用時間：10秒
DML実施数：150（10レコード一括インサート×30 = 30回）
1DMLのレコード数（10,000）
SOSLクエリ：20
futureアノテーションを持つメソッド数：50
ヒープサイズ：6MB
SOQL：100
